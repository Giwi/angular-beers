# AngularBeer - AngularJS tutorial - Step 05 #

Enough of building an app with five beers in a hard-coded dataset! Let's fetch a larger dataset from our server using one of Angular's built-in services called `$http`. We will use Angular's dependency injection (DI) to provide the service to the `BeerListCtrl` controller.

## Data ##

Our new dataset is now a list of 11 beers stored in JSON format in the `app/beers/beers.json` file in your project.
This file is available from the server at the URL http://127.0.0.1:8000/app/beers/beers.json

`app/beers/beers.json`:

```json
[
  ...
  {
    "alcohol": 6.8,
    "description": "A reddish-brown abbey ale brewed with dark malts. The secondary fermentation gives a fruity aroma and a unique spicy character with a distinctive aftertaste. Secondary fermentation in the bottle.",
    "id": "AffligemDubbel",
    "img": "beers/img/AffligemDubbel.jpg",
    "name": "Affligem Dubbel"
  },
  ...
]
```

## Controller ##

We'll use Angular's [$http](https://docs.angularjs.org/api/ng/service/$http) service in our controller to make an HTTP request to your web server to fetch the data in the `app/beers/beers.json` file. 
`$http` is just one of several built-in [Angular services](https://docs.angularjs.org/guide/services) that handle common operations in web apps. 
Angular injects these services for you where you need them.

Services are managed by Angular's [DI subsystem](https://docs.angularjs.org/guide/di). Dependency injection helps to make your web apps both well-structured (e.g., separate components for presentation, data, and control) and loosely coupled (dependencies between components are not resolved by the components themselves, but by the DI subsystem).

`$http` makes an HTTP GET request to our web server, asking for `beers/beers.json` (the url is relative to our `index.html` file). The server responds by providing the data in the JSON file. (The response might just as well have been dynamically generated by a backend server. To the browser and our app they both look the same. For the sake of simplicity we used a JSON file in this tutorial.)

The $http service returns a [promise object](https://docs.angularjs.org/api/ng/service/$q) with a success method. We call this method to handle the asynchronous response and assign the beer data to the scope controlled by this controller, as a model called `beers`. Notice that Angular detected the JSON response and parsed it for us!

To use a service in Angular, you simply declare the names of the dependencies you need as arguments to the controller's constructor function, as follows:

```javascript
angular
  .module('AngularBeer', [])
  .controller('BeerListCtrl', ['$scope', '$http', function($scope, $http) {

    $http.get('beers/beers.json').success(function(data) {
      $scope.beers = data;
    });
    
    $scope.orderProp = 'alcohol';
  }]);

```

Angular's dependency injector provides services to your controller when the controller is being constructed. The dependency injector also takes care of creating any transitive dependencies the service may have (services often depend upon other services).

Note that the names of arguments are significant, because the injector uses these to look up the dependencies.

## $ Prefix Naming Convention ##

You can create your own services, and in fact we will do exactly that in [step 11](../step-11). As a naming convention, Angular's built-in services, `Scope` methods and a few other Angular APIs have a `$` prefix in front of the name.

The `$` prefix is there to namespace Angular-provided services. To prevent collisions it's best to avoid naming your services and models anything that begins with a `$`.

If you inspect a Scope, you may also notice some properties that begin with `$$`. These properties are considered private, and should not be accessed or modified.


## A Note on Minification ##

Since Angular infers the controller's dependencies from the names of arguments to the controller's constructor function, if you were to minify the JavaScript code for `BeerListCtrl` controller, all of its function arguments would be minified as well, and the dependency injector would not be able to identify services correctly.

We can overcome this problem by annotating the function with the names of the dependencies, provided as strings, which will not get minified. There are two ways to provide these injection annotations:

* Create a `$inject` property on the controller function which holds an array of strings. Each string in the array is the name of the service to 
  inject for the corresponding parameter. In our example we would write:

  ```javascript
  function BeerListCtrl($scope, $http) {...}
  BeerListCtrl.$inject = ['$scope', '$http'];
  angularBeer.controller('BeerListCtrl', BeerListCtrl);
  ```

* Use an inline annotation where, instead of just providing the function, you provide an array. This array contains a list of the service names, 
  followed by the function itself.

  ```javascript
  function BeerListCtrl($scope, $http) {...}
  angularBeer.controller('BeerListCtrl', ['$scope', '$http', BeerListCtrl]);
  ```

Both of these methods work with any function that can be injected by Angular, so it's up to your project's style guide to decide which one you use.

When using the second method, it is common to provide the constructor function inline as an anonymous function when registering the controller:

  ```javascript
  angularBeer.controller('BeerListCtrl', ['$scope', '$http', function($scope, $http) {...}]);
  ```

This is the method we have choses for this tutorial.



## Experiments ##

At the bottom of `index.html`, add a `<pre>{{beers | json}}</pre>` binding to see the list of beers displayed in json format.

In the BeerListCtrl controller, pre-process the http response by limiting the number of beers to the first 5 in the list. 
Use the following code in the `$http` callback:

```javascript
$scope.beers = data.splice(0, 5);
```

## Summary ##

Now that you have learned how easy it is to use Angular services (thanks to Angular's dependency injection), go to [step 6](../step-06), where you will add some thumbnail images of beers and some links.
